# Custom SNORT Rules for AI Enhancement Evaluation
# These rules demonstrate the local rule loading capability

# Rule 1: Suspicious HTTP requests to admin interfaces
alert tcp any any -> any 80 (msg:"Suspicious HTTP Request - Admin Access"; content:"GET /admin"; nocase; http_method; sid:1000001; rev:1; classtype:attempted-admin; priority:2;)

# Rule 2: Potential SQL injection attempts
alert tcp any any -> any 80 (msg:"Potential SQL Injection Attempt"; content:"union select"; nocase; http_uri; sid:1000002; rev:1; classtype:attempted-user; priority:1;)

# Rule 3: Malware signature detection
alert tcp any any -> any any (msg:"Malware Signature Detected"; content:"|4d 5a 90 00|"; sid:1000003; rev:1; classtype:trojan-activity; priority:1;)

# Rule 4: Port scan detection (enhanced)
alert tcp any any -> any any (msg:"Port Scan Detected"; flags:S; threshold:type both,track by_src,count 10,seconds 60; sid:1000004; rev:1; classtype:attempted-recon; priority:2;)

# Rule 5: Suspicious DNS queries
alert udp any any -> any 53 (msg:"Suspicious DNS Query Pattern"; content:"|01 00 00 01 00 00 00 00 00 00|"; sid:1000005; rev:1; classtype:misc-activity; priority:3;)

# Rule 6: Command injection attempts
alert tcp any any -> any 80 (msg:"Command Injection Attempt"; content:"|3b 2f 62 69 6e 2f|"; nocase; http_uri; sid:1000006; rev:1; classtype:attempted-user; priority:1;)

# Rule 7: Cross-site scripting (XSS) attempts
alert tcp any any -> any 80 (msg:"XSS Attempt Detected"; content:"<script"; nocase; http_uri; sid:1000007; rev:1; classtype:attempted-user; priority:2;)

# Rule 8: Directory traversal attempts
alert tcp any any -> any 80 (msg:"Directory Traversal Attempt"; content:"../"; nocase; http_uri; sid:1000008; rev:1; classtype:attempted-user; priority:2;)

# Rule 9: Suspicious file upload attempts
alert tcp any any -> any 80 (msg:"Suspicious File Upload"; content:"Content-Type: application/x-php"; nocase; http_header; sid:1000009; rev:1; classtype:attempted-user; priority:2;)

# Rule 10: Brute force login attempts
alert tcp any any -> any 80 (msg:"Brute Force Login Attempt"; content:"login"; nocase; http_uri; threshold:type both,track by_src,count 5,seconds 60; sid:1000010; rev:1; classtype:attempted-user; priority:2;)

# Rule 11: Suspicious user agent strings
alert tcp any any -> any 80 (msg:"Suspicious User Agent"; content:"sqlmap"; nocase; http_header; sid:1000011; rev:1; classtype:attempted-recon; priority:3;)

# Rule 12: Information disclosure attempts
alert tcp any any -> any 80 (msg:"Information Disclosure Attempt"; content:"/etc/passwd"; nocase; http_uri; sid:1000012; rev:1; classtype:attempted-user; priority:2;)

# Rule 13: Suspicious network traffic patterns
alert tcp any any -> any any (msg:"Suspicious Network Pattern"; flags:A; threshold:type both,track by_src,count 100,seconds 10; sid:1000013; rev:1; classtype:misc-activity; priority:3;)

# Rule 14: Cryptocurrency mining detection
alert tcp any any -> any 80 (msg:"Cryptocurrency Mining Activity"; content:"stratum"; nocase; http_uri; sid:1000014; rev:1; classtype:trojan-activity; priority:2;)

# Rule 15: Data exfiltration attempt
alert tcp any any -> any any (msg:"Potential Data Exfiltration"; content:"|ff ff ff ff ff ff ff ff|"; threshold:type both,track by_src,count 3,seconds 60; sid:1000015; rev:1; classtype:attempted-user; priority:1;)
